pr:
  branches:
    include:
    - master

pool:
  vmImage: 'ubuntu-latest'

steps:
- bash: | 
    yarn
  displayName: 'Install Node Modules'
- bash: | 
    yarn build
  displayName: 'Build'
- bash: |
    yarn test:lh:ci --url=http://localhost:9000/using-wpp-targets-file-together-sitecore/
  displayName: 'Lighthouse'
- task: PublishPipelineArtifact@1
  displayName: 'Publish Lighthouse Reports'
  inputs:
    targetPath: $(Build.SourcesDirectory)/.lighthouseci
    artifact: 'lighthouse_reports'
- bash: |
    yarn test:lh:assert
  displayName: 'Lighthouse Assert'